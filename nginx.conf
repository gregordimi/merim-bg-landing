server {
    # Nginx listens on port 80, which Traefik/EasyPanel will map externally
    listen 80;

    # Set the root directory for serving files (where the Vite 'dist' content is copied)
    root /usr/share/nginx/html;

    # Define the default index file
    index index.html index.htm;

    # --- CRUCIAL BLOCK FOR SPA ROUTING ---
    location / {
        # 1. Try to serve the exact file requested (e.g., /assets/main.js)
        # 2. Try to serve the URI as a directory (e.g., /dashboard/ -> /dashboard/index.html)
        # 3. If neither is found (i.e., it's an app route like /about),
        #    silently rewrite the request to /index.html and maintain the URL in the browser.
        try_files $uri $uri/ /index.html;
    }

    # Optional: Cache static assets aggressively
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 30d;
        log_not_found off;
    }
}
